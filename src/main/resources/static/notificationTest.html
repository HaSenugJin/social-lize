<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script type="text/javascript" src="/javascript/sidebar.js"></script>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/style.css">
    <!-- Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/popper.min.js"></script>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <!-- Bootstrap JavaScript -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.3/js/bootstrap.min.js"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
          integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Your custom styles -->
    <link rel="stylesheet" href="/css/style.css">

    <title>Document</title>

    <style>
        /* 드롭다운 스타일 통일 */
        .header-dropdown-item-content {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .header-dropdown-item-content:last-child {
            border-bottom: none;
        }

        .header-dropdown-text {
            display: flex;
            flex-direction: column;
        }

        .header-dropdown-title {
            font-weight: bold;
            margin: 0;
        }

        .header-dropdown-message {
            margin: 0;
            color: #6c757d;
        }

        .header-dropdown-time {
            margin: 0;
            font-size: 0.8em;
            color: #adb5bd;
        }

        .header-dropdown-image img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 50%;
            margin-right: 20px;
            border: #adb5bd solid 1px;
        }
    </style>
</head>

<body>
<div class="header">
    <div class="logo">
        <img src="/images/logonobg.png" alt="로고">
    </div>
    <div class="search-bar">
        <input type="text" placeholder="소셜, 페이지, 게시글 검색">
        <i class="fas fa-search"></i>
    </div>
    <div class="menu">
        <!-- 알림 드롭다운 -->
        <div class="dropdown">
            <a href="#" class="icon dropdown-toggle" id="dropdownNotification" data-bs-toggle="dropdown"
               aria-expanded="false">
                <i class="fas fa-bell"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownNotification">
                <!-- 알림 아이템 더미 데이터 -->
                {{#notifications}
                <li class="dropdown-item" id="notification-template">
                    <div class="header-dropdown-item-content">
                        <div class="header-dropdown-text">
                            <p class="header-dropdown-title">알림 제목 1</p>
                            <p class="header-dropdown-message">알림 메시지 1</p>
                            <p class="header-dropdown-time">10분 전</p>
                        </div>
                    </div>
                </li>
                {{/notifications}
<!--                <li class="dropdown-item">-->
<!--                    <div class="header-dropdown-item-content">-->
<!--                        <div class="header-dropdown-text">-->
<!--                            <p class="header-dropdown-title">알림 제목 2</p>-->
<!--                            <p class="header-dropdown-message">알림 메시지 2</p>-->
<!--                            <p class="header-dropdown-time">20분 전</p>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </li>-->
<!--                <li class="dropdown-item">-->
<!--                    <div class="header-dropdown-item-content">-->
<!--                        <div class="header-dropdown-text">-->
<!--                            <p class="header-dropdown-title">알림 제목 3</p>-->
<!--                            <p class="header-dropdown-message">알림 메시지 3</p>-->
<!--                            <p class="header-dropdown-time">30분 전</p>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </li>-->
            </ul>
        </div>
        <!-- 채팅 드롭다운 -->
        <div class="dropdown">
            <a href="#" class="icon dropdown-toggle" id="dropdownChat" data-bs-toggle="dropdown"
               aria-expanded="false">
                <i class="fas fa-comments"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownChat">
                <!-- 채팅 아이템 더미 데이터 -->
                <li class="dropdown-item">
                    <div class="header-dropdown-item-content">
                        <div class="header-dropdown-image">
                            <img src="/images/logo.png" alt="Chat 1">
                        </div>
                        <div class="header-dropdown-text">
                            <p class="header-dropdown-title">SNS 프로젝트 1조</p>
                            <p class="header-dropdown-message">밴드 전체 멤버들과 함께 하는 채팅방</p>
                            <p class="header-dropdown-time">6월 17일</p>
                        </div>
                    </div>
                </li>
                <li class="dropdown-item">
                    <div class="header-dropdown-item-content">
                        <div class="header-dropdown-image">
                            <img src="/images/socialCover.jpg" alt="Chat 2">
                        </div>
                        <div class="header-dropdown-text">
                            <p class="header-dropdown-title">SNS 프로젝트 1조</p>
                            <p class="header-dropdown-message">밴드 전체 멤버들과 함께 하는 채팅방</p>
                            <p class="header-dropdown-time">6월 21일</p>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <!-- 마이페이지 드롭다운 -->
        <div class="dropdown">
            <a href="#" class="icon dropdown-toggle" id="dropdownUser" data-bs-toggle="dropdown"
               aria-expanded="false">
                <i class="fas fa-user"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownUser">
                <!-- 드롭다운 아이템들 -->
                <li><a class="dropdown-item m-0" href="#">프로필</a></li>
                <li><a class="dropdown-item m-0" href="#">설정</a></li>
            </ul>
        </div>
    </div>
</div>

<!-- 알림 및 채팅 데이터 업데이트 -->
<script>
    $(document).ready(function () {
        function fetchData() {
            $.ajax({
                url: '/api/main', // 서버의 데이터 API 경로
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    // 알림 및 채팅 데이터 처리
                    var notificationTemplate = $('#notification-template').html();
                    var renderedNotifications = Mustache.render(notificationTemplate, { notifications: data.notifications });

                    //
                    // $('#dropdownNotification .dropdown-menu').html(renderedNotifications);
                    //
                    // var chatTemplate = $('#chat-template').html();
                    // var renderedChats = Mustache.render(chatTemplate, { chats: data.chats });
                    // $('#dropdownChat .dropdown-menu').html(renderedChats);
                },
                error: function (error) {
                    console.log('데이터를 불러오는 데 실패했습니다.', error);
                }
            });
        }

        // 3초마다 알림 및 채팅 데이터를 새로고침
        // setInterval(fetchData, 3000);
</script>